<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_HADDOCK hide #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.TLS.Crypto</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier">HashContext</span></a></span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier">HashCtx</span></a></span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier">hashInit</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier">hashUpdate</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashUpdateSSL"><span class="hs-identifier">hashUpdateSSL</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier">hashFinal</span></a></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html"><span class="hs-identifier">Network.TLS.Crypto.DH</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html"><span class="hs-identifier">Network.TLS.Crypto.IES</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html"><span class="hs-identifier">Network.TLS.Crypto.Types</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Hash</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier">hash</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier">Hash</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashName"><span class="hs-identifier">hashName</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier">hashDigestSize</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier">hashBlockSize</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * key exchange generic interface</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PubKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PrivKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#PublicKey"><span class="hs-identifier">PublicKey</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#PrivateKey"><span class="hs-identifier">PrivateKey</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SignatureParams"><span class="hs-identifier">SignatureParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#isKeyExchangeSignatureKey"><span class="hs-identifier">isKeyExchangeSignatureKey</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#findKeyExchangeSignatureAlg"><span class="hs-identifier">findKeyExchangeSignatureAlg</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#findFiniteFieldGroup"><span class="hs-identifier">findFiniteFieldGroup</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#findEllipticCurveGroup"><span class="hs-identifier">findEllipticCurveGroup</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#kxEncrypt"><span class="hs-identifier">kxEncrypt</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#kxDecrypt"><span class="hs-identifier">kxDecrypt</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier">kxSign</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier">kxVerify</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#kxCanUseRSApkcs1"><span class="hs-identifier">kxCanUseRSApkcs1</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#kxCanUseRSApss"><span class="hs-identifier">kxCanUseRSApss</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier">KxError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#RSAEncoding"><span class="hs-identifier">RSAEncoding</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">convert</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Error</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Number.Basic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">numBits</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Random</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.DH</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DH</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.DSA</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DSA</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.ECC.ECDSA</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ECDSA</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.ECC.Types</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ECC</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Ed25519</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed25519</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Ed448</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed448</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.RSA</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RSA</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.RSA.PKCS15</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RSA</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.RSA.PSS</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PSS</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrivKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PubKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PubKeyEC</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509.EC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ecPubKeyCurveName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unserializePoint</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html"><span class="hs-identifier">Network.TLS.Crypto.DH</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html"><span class="hs-identifier">Network.TLS.Crypto.IES</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html"><span class="hs-identifier">Network.TLS.Crypto.Types</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Imports.html"><span class="hs-identifier">Network.TLS.Imports</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Types</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Encoding</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BinaryEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DER</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">BER</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">PublicKey</span><span> </span><span class="hs-pragma">&quot;use PubKey&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-70"></span><span class="hs-keyword">type</span><span> </span><span id="PublicKey"><span class="annot"><a href="Network.TLS.Crypto.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span>
</span><span id="line-71"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">PrivateKey</span><span> </span><span class="hs-pragma">&quot;use PrivKey&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span id="PrivateKey"><span class="annot"><a href="Network.TLS.Crypto.html#PrivateKey"><span class="hs-identifier hs-var">PrivateKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKey</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">data</span><span> </span><span id="KxError"><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier hs-var">KxError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>      </span><span id="RSAError"><span class="annot"><a href="Network.TLS.Crypto.html#RSAError"><span class="hs-identifier hs-var">RSAError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.Error</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KxUnsupported"><span class="annot"><a href="Network.TLS.Crypto.html#KxUnsupported"><span class="hs-identifier hs-var">KxUnsupported</span></a></span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213580"><span id="local-6989586621679213582"><span id="local-6989586621679213584"><span class="annot"><span class="annottext">Int -&gt; KxError -&gt; ShowS
[KxError] -&gt; ShowS
KxError -&gt; String
(Int -&gt; KxError -&gt; ShowS)
-&gt; (KxError -&gt; String) -&gt; ([KxError] -&gt; ShowS) -&gt; Show KxError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [KxError] -&gt; ShowS
$cshowList :: [KxError] -&gt; ShowS
show :: KxError -&gt; String
$cshow :: KxError -&gt; String
showsPrec :: Int -&gt; KxError -&gt; ShowS
$cshowsPrec :: Int -&gt; KxError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Network.TLS.Crypto.html#isKeyExchangeSignatureKey"><span class="hs-identifier hs-type">isKeyExchangeSignatureKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#KeyExchangeSignatureAlg"><span class="hs-identifier hs-type">KeyExchangeSignatureAlg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-80"></span><span id="isKeyExchangeSignatureKey"><span class="annot"><span class="annottext">isKeyExchangeSignatureKey :: KeyExchangeSignatureAlg -&gt; PubKey -&gt; Bool
</span><a href="Network.TLS.Crypto.html#isKeyExchangeSignatureKey"><span class="hs-identifier hs-var hs-var">isKeyExchangeSignatureKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg -&gt; PubKey -&gt; Bool
</span><a href="#local-6989586621679213578"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679213578"><span class="annot"><span class="annottext">f :: KeyExchangeSignatureAlg -&gt; PubKey -&gt; Bool
</span><a href="#local-6989586621679213578"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#KX_RSA"><span class="hs-identifier hs-type">KX_RSA</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span>     </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="#local-6989586621679213578"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#KX_DSS"><span class="hs-identifier hs-type">KX_DSS</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyDSA</span></span><span>     </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="#local-6989586621679213578"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#KX_ECDSA"><span class="hs-identifier hs-type">KX_ECDSA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEC</span></span><span>      </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="#local-6989586621679213578"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#KX_ECDSA"><span class="hs-identifier hs-type">KX_ECDSA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd25519</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="#local-6989586621679213578"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#KX_ECDSA"><span class="hs-identifier hs-type">KX_ECDSA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd448</span></span><span>   </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="#local-6989586621679213578"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Network.TLS.Crypto.html#findKeyExchangeSignatureAlg"><span class="hs-identifier hs-type">findKeyExchangeSignatureAlg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKey</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#KeyExchangeSignatureAlg"><span class="hs-identifier hs-type">KeyExchangeSignatureAlg</span></a></span><span>
</span><span id="line-90"></span><span id="findKeyExchangeSignatureAlg"><span class="annot"><span class="annottext">findKeyExchangeSignatureAlg :: (PubKey, PrivKey) -&gt; Maybe KeyExchangeSignatureAlg
</span><a href="Network.TLS.Crypto.html#findKeyExchangeSignatureAlg"><span class="hs-identifier hs-var hs-var">findKeyExchangeSignatureAlg</span></a></span></span><span> </span><span id="local-6989586621679213569"><span class="annot"><span class="annottext">keyPair :: (PubKey, PrivKey)
</span><a href="#local-6989586621679213569"><span class="hs-identifier hs-var">keyPair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(PubKey, PrivKey)
</span><a href="#local-6989586621679213569"><span class="hs-identifier hs-var">keyPair</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span>     </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKeyRSA</span></span><span>      </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg -&gt; Maybe KeyExchangeSignatureAlg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg
</span><a href="Network.TLS.Crypto.Types.html#KX_RSA"><span class="hs-identifier hs-var">KX_RSA</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyDSA</span></span><span>     </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKeyDSA</span></span><span>      </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg -&gt; Maybe KeyExchangeSignatureAlg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg
</span><a href="Network.TLS.Crypto.Types.html#KX_DSS"><span class="hs-identifier hs-var">KX_DSS</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEC</span></span><span>      </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKeyEC</span></span><span>       </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg -&gt; Maybe KeyExchangeSignatureAlg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg
</span><a href="Network.TLS.Crypto.Types.html#KX_ECDSA"><span class="hs-identifier hs-var">KX_ECDSA</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd25519</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKeyEd25519</span></span><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg -&gt; Maybe KeyExchangeSignatureAlg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg
</span><a href="Network.TLS.Crypto.Types.html#KX_ECDSA"><span class="hs-identifier hs-var">KX_ECDSA</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd448</span></span><span>   </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKeyEd448</span></span><span>    </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg -&gt; Maybe KeyExchangeSignatureAlg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyExchangeSignatureAlg
</span><a href="Network.TLS.Crypto.Types.html#KX_ECDSA"><span class="hs-identifier hs-var">KX_ECDSA</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-identifier">_</span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe KeyExchangeSignatureAlg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Network.TLS.Crypto.html#findFiniteFieldGroup"><span class="hs-identifier hs-type">findFiniteFieldGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DH.Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span>
</span><span id="line-100"></span><span id="findFiniteFieldGroup"><span class="annot"><span class="annottext">findFiniteFieldGroup :: Params -&gt; Maybe Group
</span><a href="Network.TLS.Crypto.html#findFiniteFieldGroup"><span class="hs-identifier hs-var hs-var">findFiniteFieldGroup</span></a></span></span><span> </span><span id="local-6989586621679213563"><span class="annot"><span class="annottext">params :: Params
</span><a href="#local-6989586621679213563"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; [((Integer, Integer), Group)] -&gt; Maybe Group
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; (Integer, Integer)
</span><a href="#local-6989586621679213561"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679213563"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[((Integer, Integer), Group)]
</span><a href="#local-6989586621679213560"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679213561"><span class="annot"><span class="annottext">pg :: Params -&gt; (Integer, Integer)
</span><a href="#local-6989586621679213561"><span class="hs-identifier hs-var hs-var">pg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DH.Params</span></span><span> </span><span id="local-6989586621679213558"><span class="annot"><span class="annottext">p :: Integer
</span><a href="#local-6989586621679213558"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679213557"><span class="annot"><span class="annottext">g :: Integer
</span><a href="#local-6989586621679213557"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679213558"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679213557"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679213560"><span class="annot"><span class="annottext">table :: [((Integer, Integer), Group)]
</span><a href="#local-6989586621679213560"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; (Integer, Integer)
</span><a href="#local-6989586621679213561"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679213556"><span class="hs-identifier hs-var">prms</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679213555"><span class="hs-identifier hs-var">grp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679213555"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679213555"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Group]
</span><a href="Network.TLS.Crypto.Types.html#availableFFGroups"><span class="hs-identifier hs-var">availableFFGroups</span></a></span><span>
</span><span id="line-105"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679213556"><span class="annot"><span class="annottext">prms :: Params
</span><a href="#local-6989586621679213556"><span class="hs-identifier hs-var">prms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Group -&gt; Maybe Params
</span><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-var">dhParamsForGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679213555"><span class="hs-identifier hs-var">grp</span></a></span><span>
</span><span id="line-106"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Network.TLS.Crypto.html#findEllipticCurveGroup"><span class="hs-identifier hs-type">findEllipticCurveGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PubKeyEC</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span>
</span><span id="line-109"></span><span id="findEllipticCurveGroup"><span class="annot"><span class="annottext">findEllipticCurveGroup :: PubKeyEC -&gt; Maybe Group
</span><a href="Network.TLS.Crypto.html#findEllipticCurveGroup"><span class="hs-identifier hs-var hs-var">findEllipticCurveGroup</span></a></span></span><span> </span><span id="local-6989586621679213552"><span class="annot"><span class="annottext">ecPub :: PubKeyEC
</span><a href="#local-6989586621679213552"><span class="hs-identifier hs-var">ecPub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PubKeyEC -&gt; Maybe CurveName
</span><span class="hs-identifier hs-var">ecPubKeyCurveName</span></span><span> </span><span class="annot"><span class="annottext">PubKeyEC
</span><a href="#local-6989586621679213552"><span class="hs-identifier hs-var">ecPub</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ECC.SEC_p256r1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Group -&gt; Maybe Group
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P256"><span class="hs-identifier hs-var">P256</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ECC.SEC_p384r1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Group -&gt; Maybe Group
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P384"><span class="hs-identifier hs-var">P384</span></a></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ECC.SEC_p521r1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Group -&gt; Maybe Group
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P521"><span class="hs-identifier hs-var">P521</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Group
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- functions to use the hidden class.</span><span>
</span><span id="line-117"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-type">hashInit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-type">HashContext</span></a></span><span>
</span><span id="line-118"></span><span id="hashInit"><span class="annot"><span class="annottext">hashInit :: Hash -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var hs-var">hashInit</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextSimple -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ContextSimple -&gt; HashContext) -&gt; ContextSimple -&gt; HashContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context MD5 -&gt; ContextSimple
forall alg. HashAlgorithm alg =&gt; Context alg -&gt; ContextSimple
</span><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context MD5
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.MD5</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextSimple -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ContextSimple -&gt; HashContext) -&gt; ContextSimple -&gt; HashContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context SHA1 -&gt; ContextSimple
forall alg. HashAlgorithm alg =&gt; Context alg -&gt; ContextSimple
</span><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA1
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextSimple -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ContextSimple -&gt; HashContext) -&gt; ContextSimple -&gt; HashContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context SHA224 -&gt; ContextSimple
forall alg. HashAlgorithm alg =&gt; Context alg -&gt; ContextSimple
</span><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA224
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA224</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextSimple -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ContextSimple -&gt; HashContext) -&gt; ContextSimple -&gt; HashContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context SHA256 -&gt; ContextSimple
forall alg. HashAlgorithm alg =&gt; Context alg -&gt; ContextSimple
</span><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA256
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextSimple -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ContextSimple -&gt; HashContext) -&gt; ContextSimple -&gt; HashContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context SHA384 -&gt; ContextSimple
forall alg. HashAlgorithm alg =&gt; Context alg -&gt; ContextSimple
</span><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA384
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA384</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextSimple -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ContextSimple -&gt; HashContext) -&gt; ContextSimple -&gt; HashContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context SHA512 -&gt; ContextSimple
forall alg. HashAlgorithm alg =&gt; Context alg -&gt; ContextSimple
</span><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA512
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA512</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-type">SHA1_MD5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context SHA1 -&gt; Context MD5 -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContextSSL"><span class="hs-identifier hs-var">HashContextSSL</span></a></span><span> </span><span class="annot"><span class="annottext">Context SHA1
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span> </span><span class="annot"><span class="annottext">Context MD5
forall a. HashAlgorithm a =&gt; Context a
</span><span class="hs-identifier hs-var">H.hashInit</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-type">hashUpdate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-type">HashContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span>
</span><span id="line-127"></span><span id="hashUpdate"><span class="annot"><span class="annottext">hashUpdate :: HashContext -&gt; ByteString -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var hs-var">hashUpdate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-type">HashContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-type">ContextSimple</span></a></span><span> </span><span id="local-6989586621679213534"><span class="annot"><span class="annottext">h :: Context alg
</span><a href="#local-6989586621679213534"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213533"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213533"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContextSimple -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ContextSimple -&gt; HashContext) -&gt; ContextSimple -&gt; HashContext
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context alg -&gt; ContextSimple
forall alg. HashAlgorithm alg =&gt; Context alg -&gt; ContextSimple
</span><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context alg -&gt; ByteString -&gt; Context alg
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
Context a -&gt; ba -&gt; Context a
</span><span class="hs-identifier hs-var">H.hashUpdate</span></span><span> </span><span class="annot"><span class="annottext">Context alg
</span><a href="#local-6989586621679213534"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213533"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#HashContextSSL"><span class="hs-identifier hs-type">HashContextSSL</span></a></span><span> </span><span id="local-6989586621679213531"><span class="annot"><span class="annottext">sha1Ctx :: Context SHA1
</span><a href="#local-6989586621679213531"><span class="hs-identifier hs-var">sha1Ctx</span></a></span></span><span> </span><span id="local-6989586621679213530"><span class="annot"><span class="annottext">md5Ctx :: Context MD5
</span><a href="#local-6989586621679213530"><span class="hs-identifier hs-var">md5Ctx</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213529"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213529"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">Context SHA1 -&gt; Context MD5 -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContextSSL"><span class="hs-identifier hs-var">HashContextSSL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA1 -&gt; ByteString -&gt; Context SHA1
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
Context a -&gt; ba -&gt; Context a
</span><span class="hs-identifier hs-var">H.hashUpdate</span></span><span> </span><span class="annot"><span class="annottext">Context SHA1
</span><a href="#local-6989586621679213531"><span class="hs-identifier hs-var">sha1Ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213529"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context MD5 -&gt; ByteString -&gt; Context MD5
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
Context a -&gt; ba -&gt; Context a
</span><span class="hs-identifier hs-var">H.hashUpdate</span></span><span> </span><span class="annot"><span class="annottext">Context MD5
</span><a href="#local-6989586621679213530"><span class="hs-identifier hs-var">md5Ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213529"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashUpdateSSL"><span class="hs-identifier hs-type">hashUpdateSSL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span>
</span><span id="line-132"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ (for the md5 context, for the sha1 context)</span><span>
</span><span id="line-133"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span>
</span><span id="line-134"></span><span id="hashUpdateSSL"><span class="annot"><span class="annottext">hashUpdateSSL :: HashContext -&gt; (ByteString, ByteString) -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#hashUpdateSSL"><span class="hs-identifier hs-var hs-var">hashUpdateSSL</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-type">HashContext</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; HashContext
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;internal error: update SSL without a SSL Context&quot;</span></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashUpdateSSL"><span class="hs-identifier hs-var">hashUpdateSSL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#HashContextSSL"><span class="hs-identifier hs-type">HashContextSSL</span></a></span><span> </span><span id="local-6989586621679213527"><span class="annot"><span class="annottext">sha1Ctx :: Context SHA1
</span><a href="#local-6989586621679213527"><span class="hs-identifier hs-var">sha1Ctx</span></a></span></span><span> </span><span id="local-6989586621679213526"><span class="annot"><span class="annottext">md5Ctx :: Context MD5
</span><a href="#local-6989586621679213526"><span class="hs-identifier hs-var">md5Ctx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213525"><span class="annot"><span class="annottext">b1 :: ByteString
</span><a href="#local-6989586621679213525"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679213524"><span class="annot"><span class="annottext">b2 :: ByteString
</span><a href="#local-6989586621679213524"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">Context SHA1 -&gt; Context MD5 -&gt; HashContext
</span><a href="Network.TLS.Crypto.html#HashContextSSL"><span class="hs-identifier hs-var">HashContextSSL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA1 -&gt; ByteString -&gt; Context SHA1
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
Context a -&gt; ba -&gt; Context a
</span><span class="hs-identifier hs-var">H.hashUpdate</span></span><span> </span><span class="annot"><span class="annottext">Context SHA1
</span><a href="#local-6989586621679213527"><span class="hs-identifier hs-var">sha1Ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213524"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context MD5 -&gt; ByteString -&gt; Context MD5
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
Context a -&gt; ba -&gt; Context a
</span><span class="hs-identifier hs-var">H.hashUpdate</span></span><span> </span><span class="annot"><span class="annottext">Context MD5
</span><a href="#local-6989586621679213526"><span class="hs-identifier hs-var">md5Ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213525"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-type">hashFinal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-139"></span><span id="hashFinal"><span class="annot"><span class="annottext">hashFinal :: HashContext -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var hs-var">hashFinal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-type">HashContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-type">ContextSimple</span></a></span><span> </span><span id="local-6989586621679213523"><span class="annot"><span class="annottext">h :: Context alg
</span><a href="#local-6989586621679213523"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest alg -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest alg -&gt; ByteString) -&gt; Digest alg -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context alg -&gt; Digest alg
forall a. HashAlgorithm a =&gt; Context a -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hashFinalize</span></span><span> </span><span class="annot"><span class="annottext">Context alg
</span><a href="#local-6989586621679213523"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var">hashFinal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#HashContextSSL"><span class="hs-identifier hs-type">HashContextSSL</span></a></span><span> </span><span id="local-6989586621679213521"><span class="annot"><span class="annottext">sha1Ctx :: Context SHA1
</span><a href="#local-6989586621679213521"><span class="hs-identifier hs-var">sha1Ctx</span></a></span></span><span> </span><span id="local-6989586621679213520"><span class="annot"><span class="annottext">md5Ctx :: Context MD5
</span><a href="#local-6989586621679213520"><span class="hs-identifier hs-var">md5Ctx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Digest MD5 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context MD5 -&gt; Digest MD5
forall a. HashAlgorithm a =&gt; Context a -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hashFinalize</span></span><span> </span><span class="annot"><span class="annottext">Context MD5
</span><a href="#local-6989586621679213520"><span class="hs-identifier hs-var">md5Ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Digest SHA1 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context SHA1 -&gt; Digest SHA1
forall a. HashAlgorithm a =&gt; Context a -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hashFinalize</span></span><span> </span><span class="annot"><span class="annottext">Context SHA1
</span><a href="#local-6989586621679213521"><span class="hs-identifier hs-var">sha1Ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-keyword">data</span><span> </span><span id="Hash"><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-var">Hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MD5"><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-var">MD5</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SHA1"><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-var">SHA1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SHA224"><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-var">SHA224</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SHA256"><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-var">SHA256</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SHA384"><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-var">SHA384</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SHA512"><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-var">SHA512</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SHA1_MD5"><span class="annot"><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-var">SHA1_MD5</span></a></span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213513"><span id="local-6989586621679213515"><span id="local-6989586621679213517"><span class="annot"><span class="annottext">Int -&gt; Hash -&gt; ShowS
[Hash] -&gt; ShowS
Hash -&gt; String
(Int -&gt; Hash -&gt; ShowS)
-&gt; (Hash -&gt; String) -&gt; ([Hash] -&gt; ShowS) -&gt; Show Hash
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Hash] -&gt; ShowS
$cshowList :: [Hash] -&gt; ShowS
show :: Hash -&gt; String
$cshow :: Hash -&gt; String
showsPrec :: Int -&gt; Hash -&gt; ShowS
$cshowsPrec :: Int -&gt; Hash -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679213509"><span id="local-6989586621679213511"><span class="annot"><span class="annottext">Hash -&gt; Hash -&gt; Bool
(Hash -&gt; Hash -&gt; Bool) -&gt; (Hash -&gt; Hash -&gt; Bool) -&gt; Eq Hash
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Hash -&gt; Hash -&gt; Bool
$c/= :: Hash -&gt; Hash -&gt; Bool
== :: Hash -&gt; Hash -&gt; Bool
$c== :: Hash -&gt; Hash -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="HashContext"><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>      </span><span id="HashContext"><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-var">HashContext</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-type">ContextSimple</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HashContextSSL"><span class="annot"><a href="Network.TLS.Crypto.html#HashContextSSL"><span class="hs-identifier hs-var">HashContextSSL</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.MD5</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679213503"><span id="local-6989586621679213506"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-type">HashContext</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679213502"><span class="annot"><span class="annottext">show :: HashContext -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;hash-context&quot;</span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">data</span><span> </span><span id="ContextSimple"><span class="annot"><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679213716"><span class="annot"><a href="#local-6989586621679213716"><span class="hs-identifier hs-type">alg</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.HashAlgorithm</span></span><span> </span><span class="annot"><a href="#local-6989586621679213716"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ContextSimple"><span class="annot"><a href="Network.TLS.Crypto.html#ContextSimple"><span class="hs-identifier hs-var">ContextSimple</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">H.Context</span></span><span> </span><span class="annot"><a href="#local-6989586621679213716"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">type</span><span> </span><span id="HashCtx"><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-var">HashCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashContext"><span class="hs-identifier hs-type">HashContext</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-158"></span><span id="hash"><span class="annot"><span class="annottext">hash :: Hash -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var hs-var">hash</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span> </span><span id="local-6989586621679213500"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213500"><span class="hs-identifier hs-var">b</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest MD5 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest MD5 -&gt; ByteString)
-&gt; (ByteString -&gt; Digest MD5) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest MD5
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.MD5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213500"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span> </span><span id="local-6989586621679213497"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213497"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest SHA1 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA1 -&gt; ByteString)
-&gt; (ByteString -&gt; Digest SHA1) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA1
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213497"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span> </span><span id="local-6989586621679213496"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213496"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest SHA224 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA224 -&gt; ByteString)
-&gt; (ByteString -&gt; Digest SHA224) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA224
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA224</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213496"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span id="local-6989586621679213495"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213495"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest SHA256 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA256 -&gt; ByteString)
-&gt; (ByteString -&gt; Digest SHA256) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA256
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213495"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span id="local-6989586621679213494"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213494"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest SHA384 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA384 -&gt; ByteString)
-&gt; (ByteString -&gt; Digest SHA384) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA384
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA384</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213494"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span id="local-6989586621679213493"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213493"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest SHA512 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA512 -&gt; ByteString)
-&gt; (ByteString -&gt; Digest SHA512) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA512
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA512</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213493"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-type">SHA1_MD5</span></a></span><span> </span><span id="local-6989586621679213492"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213492"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Digest MD5 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest MD5
</span><a href="#local-6989586621679213491"><span class="hs-identifier hs-var">md5Hash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213492"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Digest SHA1 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA1
</span><a href="#local-6989586621679213490"><span class="hs-identifier hs-var">sha1Hash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213492"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="#local-6989586621679213490"><span class="hs-identifier hs-type">sha1Hash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.SHA1</span></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679213490"><span class="annot"><span class="annottext">sha1Hash :: ByteString -&gt; Digest SHA1
</span><a href="#local-6989586621679213490"><span class="hs-identifier hs-var hs-var">sha1Hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA1
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="#local-6989586621679213491"><span class="hs-identifier hs-type">md5Hash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.MD5</span></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679213491"><span class="annot"><span class="annottext">md5Hash :: ByteString -&gt; Digest MD5
</span><a href="#local-6989586621679213491"><span class="hs-identifier hs-var hs-var">md5Hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Digest MD5
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">H.hash</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashName"><span class="hs-identifier hs-type">hashName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-173"></span><span id="hashName"><span class="annot"><span class="annottext">hashName :: Hash -&gt; String
</span><a href="Network.TLS.Crypto.html#hashName"><span class="hs-identifier hs-var hs-var">hashName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-type">hashDigestSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-176"></span><span id="hashDigestSize"><span class="annot"><span class="annottext">hashDigestSize :: Hash -&gt; Int
</span><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var hs-var">hashDigestSize</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">16</span></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">20</span></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">28</span></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">32</span></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">48</span></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-type">SHA1_MD5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">36</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-type">hashBlockSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-185"></span><span id="hashBlockSize"><span class="annot"><span class="annottext">hashBlockSize :: Hash -&gt; Int
</span><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-var hs-var">hashBlockSize</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-var">hashBlockSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-var">hashBlockSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-var">hashBlockSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-var">hashBlockSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">128</span></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-var">hashBlockSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">128</span></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Network.TLS.Crypto.html#hashBlockSize"><span class="hs-identifier hs-var">hashBlockSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-type">SHA1_MD5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">{- key exchange methods encrypt and decrypt for each supported algorithm -}</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span id="local-6989586621679213682"><span class="annot"><a href="Network.TLS.Crypto.html#generalizeRSAError"><span class="hs-identifier hs-type">generalizeRSAError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679213682"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier hs-type">KxError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679213682"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-196"></span><span id="generalizeRSAError"><span class="annot"><span class="annottext">generalizeRSAError :: Either Error a -&gt; Either KxError a
</span><a href="Network.TLS.Crypto.html#generalizeRSAError"><span class="hs-identifier hs-var hs-var">generalizeRSAError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679213488"><span class="annot"><span class="annottext">e :: Error
</span><a href="#local-6989586621679213488"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KxError -&gt; Either KxError a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Error -&gt; KxError
</span><a href="Network.TLS.Crypto.html#RSAError"><span class="hs-identifier hs-var">RSAError</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679213488"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span class="annot"><a href="Network.TLS.Crypto.html#generalizeRSAError"><span class="hs-identifier hs-var">generalizeRSAError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679213487"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679213487"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either KxError a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679213487"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621679213486"><span class="annot"><a href="Network.TLS.Crypto.html#kxEncrypt"><span class="hs-identifier hs-type">kxEncrypt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679213486"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679213486"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier hs-type">KxError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-200"></span><span id="kxEncrypt"><span class="annot"><span class="annottext">kxEncrypt :: PubKey -&gt; ByteString -&gt; r (Either KxError ByteString)
</span><a href="Network.TLS.Crypto.html#kxEncrypt"><span class="hs-identifier hs-var hs-var">kxEncrypt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span> </span><span id="local-6989586621679213485"><span class="annot"><span class="annottext">pk :: PublicKey
</span><a href="#local-6989586621679213485"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213484"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213484"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error ByteString -&gt; Either KxError ByteString
forall a. Either Error a -&gt; Either KxError a
</span><a href="Network.TLS.Crypto.html#generalizeRSAError"><span class="hs-identifier hs-var">generalizeRSAError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Error ByteString -&gt; Either KxError ByteString)
-&gt; r (Either Error ByteString) -&gt; r (Either KxError ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; ByteString -&gt; r (Either Error ByteString)
forall (m :: * -&gt; *).
MonadRandom m =&gt;
PublicKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.encrypt</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213485"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213484"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxEncrypt"><span class="hs-identifier hs-var">kxEncrypt</span></a></span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either KxError ByteString -&gt; r (Either KxError ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KxError -&gt; Either KxError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">KxError
</span><a href="Network.TLS.Crypto.html#KxUnsupported"><span class="hs-identifier hs-var">KxUnsupported</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621679213481"><span class="annot"><a href="Network.TLS.Crypto.html#kxDecrypt"><span class="hs-identifier hs-type">kxDecrypt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679213481"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#PrivateKey"><span class="hs-identifier hs-type">PrivateKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679213481"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier hs-type">KxError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-204"></span><span id="kxDecrypt"><span class="annot"><span class="annottext">kxDecrypt :: PrivKey -&gt; ByteString -&gt; r (Either KxError ByteString)
</span><a href="Network.TLS.Crypto.html#kxDecrypt"><span class="hs-identifier hs-var hs-var">kxDecrypt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivKeyRSA</span></span><span> </span><span id="local-6989586621679213480"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213480"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213479"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213479"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error ByteString -&gt; Either KxError ByteString
forall a. Either Error a -&gt; Either KxError a
</span><a href="Network.TLS.Crypto.html#generalizeRSAError"><span class="hs-identifier hs-var">generalizeRSAError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Error ByteString -&gt; Either KxError ByteString)
-&gt; r (Either Error ByteString) -&gt; r (Either KxError ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; ByteString -&gt; r (Either Error ByteString)
forall (m :: * -&gt; *).
MonadRandom m =&gt;
PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.decryptSafer</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213480"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213479"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxDecrypt"><span class="hs-identifier hs-var">kxDecrypt</span></a></span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either KxError ByteString -&gt; r (Either KxError ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KxError -&gt; Either KxError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">KxError
</span><a href="Network.TLS.Crypto.html#KxUnsupported"><span class="hs-identifier hs-var">KxUnsupported</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">data</span><span> </span><span id="RSAEncoding"><span class="annot"><a href="Network.TLS.Crypto.html#RSAEncoding"><span class="hs-identifier hs-var">RSAEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RSApkcs1"><span class="annot"><a href="Network.TLS.Crypto.html#RSApkcs1"><span class="hs-identifier hs-var">RSApkcs1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="RSApss"><span class="annot"><a href="Network.TLS.Crypto.html#RSApss"><span class="hs-identifier hs-var">RSApss</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213470"><span id="local-6989586621679213472"><span id="local-6989586621679213474"><span class="annot"><span class="annottext">Int -&gt; RSAEncoding -&gt; ShowS
[RSAEncoding] -&gt; ShowS
RSAEncoding -&gt; String
(Int -&gt; RSAEncoding -&gt; ShowS)
-&gt; (RSAEncoding -&gt; String)
-&gt; ([RSAEncoding] -&gt; ShowS)
-&gt; Show RSAEncoding
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RSAEncoding] -&gt; ShowS
$cshowList :: [RSAEncoding] -&gt; ShowS
show :: RSAEncoding -&gt; String
$cshow :: RSAEncoding -&gt; String
showsPrec :: Int -&gt; RSAEncoding -&gt; ShowS
$cshowsPrec :: Int -&gt; RSAEncoding -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679213466"><span id="local-6989586621679213468"><span class="annot"><span class="annottext">RSAEncoding -&gt; RSAEncoding -&gt; Bool
(RSAEncoding -&gt; RSAEncoding -&gt; Bool)
-&gt; (RSAEncoding -&gt; RSAEncoding -&gt; Bool) -&gt; Eq RSAEncoding
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RSAEncoding -&gt; RSAEncoding -&gt; Bool
$c/= :: RSAEncoding -&gt; RSAEncoding -&gt; Bool
== :: RSAEncoding -&gt; RSAEncoding -&gt; Bool
$c== :: RSAEncoding -&gt; RSAEncoding -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Test the RSASSA-PKCS1 length condition described in RFC 8017 section 9.2,</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- i.e. @emLen &gt;= tLen + 11@.  Lengths are in bytes.</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxCanUseRSApkcs1"><span class="hs-identifier hs-type">kxCanUseRSApkcs1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PublicKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-212"></span><span id="kxCanUseRSApkcs1"><span class="annot"><span class="annottext">kxCanUseRSApkcs1 :: PublicKey -&gt; Hash -&gt; Bool
</span><a href="Network.TLS.Crypto.html#kxCanUseRSApkcs1"><span class="hs-identifier hs-var hs-var">kxCanUseRSApkcs1</span></a></span></span><span> </span><span id="local-6989586621679213465"><span class="annot"><span class="annottext">pk :: PublicKey
</span><a href="#local-6989586621679213465"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213464"><span class="annot"><span class="annottext">h :: Hash
</span><a href="#local-6989586621679213464"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; Int
</span><span class="hs-identifier hs-var hs-var">RSA.public_size</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213465"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679213462"><span class="hs-identifier hs-var">tLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">11</span></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679213462"><span class="annot"><span class="annottext">tLen :: Int
</span><a href="#local-6989586621679213462"><span class="hs-identifier hs-var hs-var">tLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; Int
forall p. Num p =&gt; Hash -&gt; p
</span><a href="#local-6989586621679213460"><span class="hs-identifier hs-var">prefixSize</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213464"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Hash -&gt; Int
</span><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213464"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679213460"><span class="annot"><span class="annottext">prefixSize :: Hash -&gt; p
</span><a href="#local-6989586621679213460"><span class="hs-identifier hs-var hs-var">prefixSize</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">18</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="#local-6989586621679213460"><span class="hs-identifier hs-var">prefixSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">15</span></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="#local-6989586621679213460"><span class="hs-identifier hs-var">prefixSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">19</span></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="#local-6989586621679213460"><span class="hs-identifier hs-var">prefixSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">19</span></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="#local-6989586621679213460"><span class="hs-identifier hs-var">prefixSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">19</span></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="#local-6989586621679213460"><span class="hs-identifier hs-var">prefixSize</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">19</span></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="#local-6989586621679213460"><span class="hs-identifier hs-var">prefixSize</span></a></span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; p
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213464"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; is not supported for RSASSA-PKCS1&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Test the RSASSA-PSS length condition described in RFC 8017 section 9.1.1,</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- i.e. @emBits &gt;= 8hLen + 8sLen + 9@.  Lengths are in bits.</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxCanUseRSApss"><span class="hs-identifier hs-type">kxCanUseRSApss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PublicKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-227"></span><span id="kxCanUseRSApss"><span class="annot"><span class="annottext">kxCanUseRSApss :: PublicKey -&gt; Hash -&gt; Bool
</span><a href="Network.TLS.Crypto.html#kxCanUseRSApss"><span class="hs-identifier hs-var hs-var">kxCanUseRSApss</span></a></span></span><span> </span><span id="local-6989586621679213459"><span class="annot"><span class="annottext">pk :: PublicKey
</span><a href="#local-6989586621679213459"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213458"><span class="annot"><span class="annottext">h :: Hash
</span><a href="#local-6989586621679213458"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><span class="hs-identifier hs-var">numBits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PublicKey -&gt; Integer
</span><span class="hs-identifier hs-var hs-var">RSA.public_n</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213459"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Hash -&gt; Int
</span><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213458"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">10</span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- Signature algorithm and associated parameters.</span><span>
</span><span id="line-230"></span><span class="hs-comment">--</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- FIXME add RSAPSSParams</span><span>
</span><span id="line-232"></span><span class="hs-keyword">data</span><span> </span><span id="SignatureParams"><span class="annot"><a href="Network.TLS.Crypto.html#SignatureParams"><span class="hs-identifier hs-var">SignatureParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>      </span><span id="RSAParams"><span class="annot"><a href="Network.TLS.Crypto.html#RSAParams"><span class="hs-identifier hs-var">RSAParams</span></a></span></span><span>      </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#RSAEncoding"><span class="hs-identifier hs-type">RSAEncoding</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DSSParams"><span class="annot"><a href="Network.TLS.Crypto.html#DSSParams"><span class="hs-identifier hs-var">DSSParams</span></a></span></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ECDSAParams"><span class="annot"><a href="Network.TLS.Crypto.html#ECDSAParams"><span class="hs-identifier hs-var">ECDSAParams</span></a></span></span><span>    </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Ed25519Params"><span class="annot"><a href="Network.TLS.Crypto.html#Ed25519Params"><span class="hs-identifier hs-var">Ed25519Params</span></a></span></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Ed448Params"><span class="annot"><a href="Network.TLS.Crypto.html#Ed448Params"><span class="hs-identifier hs-var">Ed448Params</span></a></span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679213445"><span id="local-6989586621679213447"><span id="local-6989586621679213449"><span class="annot"><span class="annottext">Int -&gt; SignatureParams -&gt; ShowS
[SignatureParams] -&gt; ShowS
SignatureParams -&gt; String
(Int -&gt; SignatureParams -&gt; ShowS)
-&gt; (SignatureParams -&gt; String)
-&gt; ([SignatureParams] -&gt; ShowS)
-&gt; Show SignatureParams
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SignatureParams] -&gt; ShowS
$cshowList :: [SignatureParams] -&gt; ShowS
show :: SignatureParams -&gt; String
$cshow :: SignatureParams -&gt; String
showsPrec :: Int -&gt; SignatureParams -&gt; ShowS
$cshowsPrec :: Int -&gt; SignatureParams -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679213441"><span id="local-6989586621679213443"><span class="annot"><span class="annottext">SignatureParams -&gt; SignatureParams -&gt; Bool
(SignatureParams -&gt; SignatureParams -&gt; Bool)
-&gt; (SignatureParams -&gt; SignatureParams -&gt; Bool)
-&gt; Eq SignatureParams
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SignatureParams -&gt; SignatureParams -&gt; Bool
$c/= :: SignatureParams -&gt; SignatureParams -&gt; Bool
== :: SignatureParams -&gt; SignatureParams -&gt; Bool
$c== :: SignatureParams -&gt; SignatureParams -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- Verify that the signature matches the given message, using the</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- public key.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-type">kxVerify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SignatureParams"><span class="hs-identifier hs-type">SignatureParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-245"></span><span id="kxVerify"><span class="annot"><span class="annottext">kxVerify :: PubKey -&gt; SignatureParams -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-var hs-var">kxVerify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span> </span><span id="local-6989586621679213440"><span class="annot"><span class="annottext">pk :: PublicKey
</span><a href="#local-6989586621679213440"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#RSAParams"><span class="hs-identifier hs-type">RSAParams</span></a></span><span> </span><span id="local-6989586621679213439"><span class="annot"><span class="annottext">alg :: Hash
</span><a href="#local-6989586621679213439"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#RSApkcs1"><span class="hs-identifier hs-type">RSApkcs1</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213438"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213438"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679213437"><span class="annot"><span class="annottext">sign :: ByteString
</span><a href="#local-6989586621679213437"><span class="hs-identifier hs-var">sign</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var">rsaVerifyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213439"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213440"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213438"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213437"><span class="hs-identifier hs-var">sign</span></a></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-var">kxVerify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span> </span><span id="local-6989586621679213435"><span class="annot"><span class="annottext">pk :: PublicKey
</span><a href="#local-6989586621679213435"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#RSAParams"><span class="hs-identifier hs-type">RSAParams</span></a></span><span> </span><span id="local-6989586621679213434"><span class="annot"><span class="annottext">alg :: Hash
</span><a href="#local-6989586621679213434"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#RSApss"><span class="hs-identifier hs-type">RSApss</span></a></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621679213433"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213433"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679213432"><span class="annot"><span class="annottext">sign :: ByteString
</span><a href="#local-6989586621679213432"><span class="hs-identifier hs-var">sign</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><a href="Network.TLS.Crypto.html#rsapssVerifyHash"><span class="hs-identifier hs-var">rsapssVerifyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213434"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213435"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213433"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213432"><span class="hs-identifier hs-var">sign</span></a></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-var">kxVerify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyDSA</span></span><span> </span><span id="local-6989586621679213430"><span class="annot"><span class="annottext">pk :: PublicKey
</span><a href="#local-6989586621679213430"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#DSSParams"><span class="hs-identifier hs-type">DSSParams</span></a></span><span>                </span><span id="local-6989586621679213429"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213429"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679213428"><span class="annot"><span class="annottext">signBS :: ByteString
</span><a href="#local-6989586621679213428"><span class="hs-identifier hs-var">signBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe Signature
</span><a href="#local-6989586621679213427"><span class="hs-identifier hs-var">dsaToSignature</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213428"><span class="hs-identifier hs-var">signBS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679213426"><span class="annot"><span class="annottext">sig :: Signature
</span><a href="#local-6989586621679213426"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SHA1 -&gt; PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
forall msg hash.
(ByteArrayAccess msg, HashAlgorithm hash) =&gt;
hash -&gt; PublicKey -&gt; Signature -&gt; msg -&gt; Bool
</span><span class="hs-identifier hs-var">DSA.verify</span></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">H.SHA1</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213430"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213426"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213429"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><a href="#local-6989586621679213427"><span class="hs-identifier hs-type">dsaToSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.Signature</span></span><span>
</span><span id="line-254"></span><span>        </span><span id="local-6989586621679213427"><span class="annot"><span class="annottext">dsaToSignature :: ByteString -&gt; Maybe Signature
</span><a href="#local-6989586621679213427"><span class="hs-identifier hs-var hs-var">dsaToSignature</span></a></span></span><span> </span><span id="local-6989586621679213423"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679213423"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213423"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-256"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Signature
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-257"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679213420"><span class="annot"><span class="annottext">asn1 :: [ASN1]
</span><a href="#local-6989586621679213420"><span class="hs-identifier hs-var">asn1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679213420"><span class="hs-identifier hs-var">asn1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Start</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sequence</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679213416"><span class="annot"><span class="annottext">r :: Integer
</span><a href="#local-6989586621679213416"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679213415"><span class="annot"><span class="annottext">s :: Integer
</span><a href="#local-6989586621679213415"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="hs-identifier hs-type">End</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sequence</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>                            </span><span class="annot"><span class="annottext">Signature -&gt; Maybe Signature
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Signature :: Integer -&gt; Integer -&gt; Signature
</span><span class="hs-identifier hs-type hs-type">DSA.Signature</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sign_r :: Integer
</span><span class="hs-identifier hs-var">DSA.sign_r</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679213416"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sign_s :: Integer
</span><span class="hs-identifier hs-var">DSA.sign_s</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679213415"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-261"></span><span>                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>                            </span><span class="annot"><span class="annottext">Maybe Signature
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-var">kxVerify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEC</span></span><span> </span><span id="local-6989586621679213409"><span class="annot"><span class="annottext">key :: PubKeyEC
</span><a href="#local-6989586621679213409"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#ECDSAParams"><span class="hs-identifier hs-type">ECDSAParams</span></a></span><span> </span><span id="local-6989586621679213408"><span class="annot"><span class="annottext">alg :: Hash
</span><a href="#local-6989586621679213408"><span class="hs-identifier hs-var">alg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213407"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213407"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679213406"><span class="annot"><span class="annottext">sigBS :: ByteString
</span><a href="#local-6989586621679213406"><span class="hs-identifier hs-var">sigBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool -&gt; Bool
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Bool) -&gt; Maybe Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- get the curve name and the public key data</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213404"><span class="annot"><span class="annottext">pubBS :: SerializedPoint
</span><a href="#local-6989586621679213404"><span class="hs-identifier hs-var hs-var">pubBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PubKeyEC -&gt; SerializedPoint
</span><span class="hs-identifier hs-var hs-var">pubkeyEC_pub</span></span><span> </span><span class="annot"><span class="annottext">PubKeyEC
</span><a href="#local-6989586621679213409"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621679213402"><span class="annot"><span class="annottext">CurveName
</span><a href="#local-6989586621679213402"><span class="hs-identifier hs-var">curveName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PubKeyEC -&gt; Maybe CurveName
</span><span class="hs-identifier hs-var">ecPubKeyCurveName</span></span><span> </span><span class="annot"><span class="annottext">PubKeyEC
</span><a href="#local-6989586621679213409"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-comment">-- decode the signature</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679213401"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213401"><span class="hs-keyword hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213406"><span class="hs-identifier hs-var">sigBS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Signature
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Start</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679213400"><span class="annot"><span class="annottext">r :: Integer
</span><a href="#local-6989586621679213400"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679213399"><span class="annot"><span class="annottext">s :: Integer
</span><a href="#local-6989586621679213399"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">End</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sequence</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Signature -&gt; Maybe Signature
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Signature -&gt; Maybe Signature) -&gt; Signature -&gt; Maybe Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Signature
</span><span class="hs-identifier hs-var">ECDSA.Signature</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679213400"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679213399"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Signature
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-comment">-- decode the public key related to the curve</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679213397"><span class="annot"><span class="annottext">curve :: Curve
</span><a href="#local-6989586621679213397"><span class="hs-identifier hs-var hs-var">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CurveName -&gt; Curve
</span><span class="hs-identifier hs-var">ECC.getCurveByName</span></span><span> </span><span class="annot"><span class="annottext">CurveName
</span><a href="#local-6989586621679213402"><span class="hs-identifier hs-var">curveName</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621679213395"><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213395"><span class="hs-identifier hs-var">pubkey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Curve -&gt; PublicPoint -&gt; PublicKey
</span><span class="hs-identifier hs-var">ECDSA.PublicKey</span></span><span> </span><span class="annot"><span class="annottext">Curve
</span><a href="#local-6989586621679213397"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicPoint -&gt; PublicKey) -&gt; Maybe PublicPoint -&gt; Maybe PublicKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Curve -&gt; SerializedPoint -&gt; Maybe PublicPoint
</span><span class="hs-identifier hs-var">unserializePoint</span></span><span> </span><span class="annot"><span class="annottext">Curve
</span><a href="#local-6989586621679213397"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">SerializedPoint
</span><a href="#local-6989586621679213404"><span class="hs-identifier hs-var">pubBS</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679213393"><span class="annot"><span class="annottext">PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
</span><a href="#local-6989586621679213393"><span class="hs-identifier hs-var">verifyF</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213408"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-278"></span><span>                    </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
-&gt; Maybe (PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MD5 -&gt; PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
forall msg hash.
(ByteArrayAccess msg, HashAlgorithm hash) =&gt;
hash -&gt; PublicKey -&gt; Signature -&gt; msg -&gt; Bool
</span><span class="hs-identifier hs-var">ECDSA.verify</span></span><span> </span><span class="annot"><span class="annottext">MD5
</span><span class="hs-identifier hs-var">H.MD5</span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>                    </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
-&gt; Maybe (PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA1 -&gt; PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
forall msg hash.
(ByteArrayAccess msg, HashAlgorithm hash) =&gt;
hash -&gt; PublicKey -&gt; Signature -&gt; msg -&gt; Bool
</span><span class="hs-identifier hs-var">ECDSA.verify</span></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">H.SHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>                    </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
-&gt; Maybe (PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA224 -&gt; PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
forall msg hash.
(ByteArrayAccess msg, HashAlgorithm hash) =&gt;
hash -&gt; PublicKey -&gt; Signature -&gt; msg -&gt; Bool
</span><span class="hs-identifier hs-var">ECDSA.verify</span></span><span> </span><span class="annot"><span class="annottext">SHA224
</span><span class="hs-identifier hs-var">H.SHA224</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>                    </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
-&gt; Maybe (PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA256 -&gt; PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
forall msg hash.
(ByteArrayAccess msg, HashAlgorithm hash) =&gt;
hash -&gt; PublicKey -&gt; Signature -&gt; msg -&gt; Bool
</span><span class="hs-identifier hs-var">ECDSA.verify</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">H.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>                    </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
-&gt; Maybe (PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA384 -&gt; PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
forall msg hash.
(ByteArrayAccess msg, HashAlgorithm hash) =&gt;
hash -&gt; PublicKey -&gt; Signature -&gt; msg -&gt; Bool
</span><span class="hs-identifier hs-var">ECDSA.verify</span></span><span> </span><span class="annot"><span class="annottext">SHA384
</span><span class="hs-identifier hs-var">H.SHA384</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>                    </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
-&gt; Maybe (PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA512 -&gt; PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
forall msg hash.
(ByteArrayAccess msg, HashAlgorithm hash) =&gt;
hash -&gt; PublicKey -&gt; Signature -&gt; msg -&gt; Bool
</span><span class="hs-identifier hs-var">ECDSA.verify</span></span><span> </span><span class="annot"><span class="annottext">SHA512
</span><span class="hs-identifier hs-var">H.SHA512</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>                    </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe Bool) -&gt; Bool -&gt; Maybe Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; Signature -&gt; ByteString -&gt; Bool
</span><a href="#local-6989586621679213393"><span class="hs-identifier hs-var">verifyF</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213395"><span class="hs-identifier hs-var">pubkey</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213401"><span class="hs-keyword hs-var">signature</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213407"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-var">kxVerify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd25519</span></span><span> </span><span id="local-6989586621679213386"><span class="annot"><span class="annottext">key :: PublicKey
</span><a href="#local-6989586621679213386"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Ed25519Params"><span class="hs-identifier hs-type">Ed25519Params</span></a></span><span> </span><span id="local-6989586621679213385"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213385"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679213384"><span class="annot"><span class="annottext">sigBS :: ByteString
</span><a href="#local-6989586621679213384"><span class="hs-identifier hs-var">sigBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable Signature
forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable Signature
</span><span class="hs-identifier hs-var">Ed25519.signature</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213384"><span class="hs-identifier hs-var">sigBS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span id="local-6989586621679213381"><span class="annot"><span class="annottext">sig :: Signature
</span><a href="#local-6989586621679213381"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; ByteString -&gt; Signature -&gt; Bool
forall ba.
ByteArrayAccess ba =&gt;
PublicKey -&gt; ba -&gt; Signature -&gt; Bool
</span><span class="hs-identifier hs-var">Ed25519.verify</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213386"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213385"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213381"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-var">kxVerify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd448</span></span><span> </span><span id="local-6989586621679213379"><span class="annot"><span class="annottext">key :: PublicKey
</span><a href="#local-6989586621679213379"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Ed448Params"><span class="hs-identifier hs-type">Ed448Params</span></a></span><span> </span><span id="local-6989586621679213378"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213378"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679213377"><span class="annot"><span class="annottext">sigBS :: ByteString
</span><a href="#local-6989586621679213377"><span class="hs-identifier hs-var">sigBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable Signature
forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable Signature
</span><span class="hs-identifier hs-var">Ed448.signature</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213377"><span class="hs-identifier hs-var">sigBS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span id="local-6989586621679213375"><span class="annot"><span class="annottext">sig :: Signature
</span><a href="#local-6989586621679213375"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; ByteString -&gt; Signature -&gt; Bool
forall ba.
ByteArrayAccess ba =&gt;
PublicKey -&gt; ba -&gt; Signature -&gt; Bool
</span><span class="hs-identifier hs-var">Ed448.verify</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213379"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213378"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213375"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxVerify"><span class="hs-identifier hs-var">kxVerify</span></a></span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-identifier">_</span><span>         </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- Sign the given message using the private key.</span><span>
</span><span id="line-297"></span><span class="hs-comment">--</span><span>
</span><span id="line-298"></span><span id="local-6989586621679213373"><span class="annot"><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier hs-type">kxSign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679213373"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-299"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#PrivateKey"><span class="hs-identifier hs-type">PrivateKey</span></a></span><span>
</span><span id="line-300"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span>
</span><span id="line-301"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SignatureParams"><span class="hs-identifier hs-type">SignatureParams</span></a></span><span>
</span><span id="line-302"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-303"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679213373"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier hs-type">KxError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-304"></span><span id="kxSign"><span class="annot"><span class="annottext">kxSign :: PrivKey
-&gt; PubKey
-&gt; SignatureParams
-&gt; ByteString
-&gt; r (Either KxError ByteString)
</span><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier hs-var hs-var">kxSign</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivKeyRSA</span></span><span> </span><span id="local-6989586621679213372"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213372"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#RSAParams"><span class="hs-identifier hs-type">RSAParams</span></a></span><span> </span><span id="local-6989586621679213371"><span class="annot"><span class="annottext">hashAlg :: Hash
</span><a href="#local-6989586621679213371"><span class="hs-identifier hs-var">hashAlg</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#RSApkcs1"><span class="hs-identifier hs-type">RSApkcs1</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213370"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213370"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">Either Error ByteString -&gt; Either KxError ByteString
forall a. Either Error a -&gt; Either KxError a
</span><a href="Network.TLS.Crypto.html#generalizeRSAError"><span class="hs-identifier hs-var">generalizeRSAError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Error ByteString -&gt; Either KxError ByteString)
-&gt; r (Either Error ByteString) -&gt; r (Either KxError ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Hash -&gt; PrivateKey -&gt; ByteString -&gt; r (Either Error ByteString)
forall (m :: * -&gt; *).
MonadRandom m =&gt;
Hash -&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var">rsaSignHash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213371"><span class="hs-identifier hs-var">hashAlg</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213372"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213370"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier hs-var">kxSign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivKeyRSA</span></span><span> </span><span id="local-6989586621679213368"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213368"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyRSA</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#RSAParams"><span class="hs-identifier hs-type">RSAParams</span></a></span><span> </span><span id="local-6989586621679213367"><span class="annot"><span class="annottext">hashAlg :: Hash
</span><a href="#local-6989586621679213367"><span class="hs-identifier hs-var">hashAlg</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#RSApss"><span class="hs-identifier hs-type">RSApss</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679213366"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213366"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">Either Error ByteString -&gt; Either KxError ByteString
forall a. Either Error a -&gt; Either KxError a
</span><a href="Network.TLS.Crypto.html#generalizeRSAError"><span class="hs-identifier hs-var">generalizeRSAError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Error ByteString -&gt; Either KxError ByteString)
-&gt; r (Either Error ByteString) -&gt; r (Either KxError ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Hash -&gt; PrivateKey -&gt; ByteString -&gt; r (Either Error ByteString)
forall (m :: * -&gt; *).
MonadRandom m =&gt;
Hash -&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><a href="Network.TLS.Crypto.html#rsapssSignHash"><span class="hs-identifier hs-var">rsapssSignHash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679213367"><span class="hs-identifier hs-var">hashAlg</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213368"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213366"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-308"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier hs-var">kxSign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivKeyDSA</span></span><span> </span><span id="local-6989586621679213364"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213364"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyDSA</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#DSSParams"><span class="hs-identifier hs-type">DSSParams</span></a></span><span> </span><span id="local-6989586621679213363"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213363"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679213362"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213362"><span class="hs-identifier hs-var">sign</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; SHA1 -&gt; ByteString -&gt; r Signature
forall msg hash (m :: * -&gt; *).
(ByteArrayAccess msg, HashAlgorithm hash, MonadRandom m) =&gt;
PrivateKey -&gt; hash -&gt; msg -&gt; m Signature
</span><span class="hs-identifier hs-var">DSA.sign</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213364"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">H.SHA1</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213363"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><span class="annottext">Either KxError ByteString -&gt; r (Either KxError ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either KxError ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either KxError ByteString)
-&gt; ByteString -&gt; Either KxError ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DER -&gt; [ASN1] -&gt; ByteString
forall a. ASN1Encoding a =&gt; a -&gt; [ASN1] -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">DER
</span><span class="hs-identifier hs-var">DER</span></span><span> </span><span class="annot"><span class="annottext">([ASN1] -&gt; ByteString) -&gt; [ASN1] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; [ASN1]
</span><a href="#local-6989586621679213358"><span class="hs-identifier hs-var">dsaSequence</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213362"><span class="hs-identifier hs-var">sign</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679213358"><span class="annot"><span class="annottext">dsaSequence :: Signature -&gt; [ASN1]
</span><a href="#local-6989586621679213358"><span class="hs-identifier hs-var hs-var">dsaSequence</span></a></span></span><span> </span><span id="local-6989586621679213357"><span class="annot"><span class="annottext">sign :: Signature
</span><a href="#local-6989586621679213357"><span class="hs-identifier hs-var">sign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer -&gt; ASN1
</span><span class="hs-identifier hs-var">IntVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signature -&gt; Integer
</span><span class="hs-identifier hs-var hs-var">DSA.sign_r</span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213357"><span class="hs-identifier hs-var">sign</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer -&gt; ASN1
</span><span class="hs-identifier hs-var">IntVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Signature -&gt; Integer
</span><span class="hs-identifier hs-var hs-var">DSA.sign_s</span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679213357"><span class="hs-identifier hs-var">sign</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier hs-var">kxSign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivKeyEd25519</span></span><span> </span><span id="local-6989586621679213356"><span class="annot"><span class="annottext">pk :: SecretKey
</span><a href="#local-6989586621679213356"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd25519</span></span><span> </span><span id="local-6989586621679213355"><span class="annot"><span class="annottext">pub :: PublicKey
</span><a href="#local-6989586621679213355"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Ed25519Params"><span class="hs-identifier hs-type">Ed25519Params</span></a></span><span> </span><span id="local-6989586621679213354"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213354"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">Either KxError ByteString -&gt; r (Either KxError ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either KxError ByteString -&gt; r (Either KxError ByteString))
-&gt; Either KxError ByteString -&gt; r (Either KxError ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either KxError ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either KxError ByteString)
-&gt; ByteString -&gt; Either KxError ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Signature -&gt; ByteString) -&gt; Signature -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PublicKey -&gt; ByteString -&gt; Signature
forall ba.
ByteArrayAccess ba =&gt;
SecretKey -&gt; PublicKey -&gt; ba -&gt; Signature
</span><span class="hs-identifier hs-var">Ed25519.sign</span></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679213356"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213355"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213354"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier hs-var">kxSign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivKeyEd448</span></span><span> </span><span id="local-6989586621679213352"><span class="annot"><span class="annottext">pk :: SecretKey
</span><a href="#local-6989586621679213352"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKeyEd448</span></span><span> </span><span id="local-6989586621679213351"><span class="annot"><span class="annottext">pub :: PublicKey
</span><a href="#local-6989586621679213351"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Ed448Params"><span class="hs-identifier hs-type">Ed448Params</span></a></span><span> </span><span id="local-6989586621679213350"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213350"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="annottext">Either KxError ByteString -&gt; r (Either KxError ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either KxError ByteString -&gt; r (Either KxError ByteString))
-&gt; Either KxError ByteString -&gt; r (Either KxError ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either KxError ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either KxError ByteString)
-&gt; ByteString -&gt; Either KxError ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Signature -&gt; ByteString) -&gt; Signature -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PublicKey -&gt; ByteString -&gt; Signature
forall ba.
ByteArrayAccess ba =&gt;
SecretKey -&gt; PublicKey -&gt; ba -&gt; Signature
</span><span class="hs-identifier hs-var">Ed448.sign</span></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679213352"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679213351"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213350"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Network.TLS.Crypto.html#kxSign"><span class="hs-identifier hs-var">kxSign</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">Either KxError ByteString -&gt; r (Either KxError ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KxError -&gt; Either KxError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">KxError
</span><a href="Network.TLS.Crypto.html#KxUnsupported"><span class="hs-identifier hs-var">KxUnsupported</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span id="local-6989586621679213638"><span class="annot"><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-type">rsaSignHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679213638"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679213638"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.Error</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-320"></span><span id="rsaSignHash"><span class="annot"><span class="annottext">rsaSignHash :: Hash -&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var hs-var">rsaSignHash</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-type">SHA1_MD5</span></a></span><span> </span><span id="local-6989586621679213348"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213348"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213347"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213347"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MD5
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hashAlg (m :: * -&gt; *).
(HashAlgorithmASN1 hashAlg, MonadRandom m) =&gt;
Maybe hashAlg
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.signSafer</span></span><span> </span><span class="annot"><span class="annottext">Maybe MD5
</span><a href="Network.TLS.Crypto.html#noHash"><span class="hs-identifier hs-var">noHash</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213348"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213347"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var">rsaSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span> </span><span id="local-6989586621679213344"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213344"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213343"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213343"><span class="hs-identifier hs-var">msg</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MD5
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hashAlg (m :: * -&gt; *).
(HashAlgorithmASN1 hashAlg, MonadRandom m) =&gt;
Maybe hashAlg
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MD5 -&gt; Maybe MD5
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MD5
</span><span class="hs-identifier hs-var">H.MD5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213344"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213343"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var">rsaSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span> </span><span id="local-6989586621679213342"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213342"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213341"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213341"><span class="hs-identifier hs-var">msg</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA1
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hashAlg (m :: * -&gt; *).
(HashAlgorithmASN1 hashAlg, MonadRandom m) =&gt;
Maybe hashAlg
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA1 -&gt; Maybe SHA1
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">H.SHA1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213342"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213341"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-323"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var">rsaSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span> </span><span id="local-6989586621679213340"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213340"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213339"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213339"><span class="hs-identifier hs-var">msg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA224
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hashAlg (m :: * -&gt; *).
(HashAlgorithmASN1 hashAlg, MonadRandom m) =&gt;
Maybe hashAlg
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA224 -&gt; Maybe SHA224
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA224
</span><span class="hs-identifier hs-var">H.SHA224</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213340"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213339"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-324"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var">rsaSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span id="local-6989586621679213338"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213338"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213337"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213337"><span class="hs-identifier hs-var">msg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA256
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hashAlg (m :: * -&gt; *).
(HashAlgorithmASN1 hashAlg, MonadRandom m) =&gt;
Maybe hashAlg
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA256 -&gt; Maybe SHA256
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">H.SHA256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213338"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213337"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var">rsaSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span id="local-6989586621679213336"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213336"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213335"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213335"><span class="hs-identifier hs-var">msg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA384
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hashAlg (m :: * -&gt; *).
(HashAlgorithmASN1 hashAlg, MonadRandom m) =&gt;
Maybe hashAlg
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA384 -&gt; Maybe SHA384
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA384
</span><span class="hs-identifier hs-var">H.SHA384</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213336"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213335"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaSignHash"><span class="hs-identifier hs-var">rsaSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span id="local-6989586621679213334"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213334"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213333"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213333"><span class="hs-identifier hs-var">msg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA512
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hashAlg (m :: * -&gt; *).
(HashAlgorithmASN1 hashAlg, MonadRandom m) =&gt;
Maybe hashAlg
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">RSA.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA512 -&gt; Maybe SHA512
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA512
</span><span class="hs-identifier hs-var">H.SHA512</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213334"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213333"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span id="local-6989586621679213332"><span class="annot"><a href="Network.TLS.Crypto.html#rsapssSignHash"><span class="hs-identifier hs-type">rsapssSignHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679213332"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679213332"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.Error</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-329"></span><span id="rsapssSignHash"><span class="annot"><span class="annottext">rsapssSignHash :: Hash -&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><a href="Network.TLS.Crypto.html#rsapssSignHash"><span class="hs-identifier hs-var hs-var">rsapssSignHash</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span id="local-6989586621679213331"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213331"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213330"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213330"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSSParams SHA256 ByteString ByteString
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hash (m :: * -&gt; *).
(HashAlgorithm hash, MonadRandom m) =&gt;
PSSParams hash ByteString ByteString
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">PSS.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA256 -&gt; PSSParams SHA256 ByteString ByteString
forall seed output hash.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hash) =&gt;
hash -&gt; PSSParams hash seed output
</span><span class="hs-identifier hs-var">PSS.defaultPSSParams</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">H.SHA256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213331"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213330"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsapssSignHash"><span class="hs-identifier hs-var">rsapssSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span id="local-6989586621679213327"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213327"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213326"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213326"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSSParams SHA384 ByteString ByteString
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hash (m :: * -&gt; *).
(HashAlgorithm hash, MonadRandom m) =&gt;
PSSParams hash ByteString ByteString
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">PSS.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA384 -&gt; PSSParams SHA384 ByteString ByteString
forall seed output hash.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hash) =&gt;
hash -&gt; PSSParams hash seed output
</span><span class="hs-identifier hs-var">PSS.defaultPSSParams</span></span><span> </span><span class="annot"><span class="annottext">SHA384
</span><span class="hs-identifier hs-var">H.SHA384</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213327"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213326"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsapssSignHash"><span class="hs-identifier hs-var">rsapssSignHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span id="local-6989586621679213325"><span class="annot"><span class="annottext">pk :: PrivateKey
</span><a href="#local-6989586621679213325"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679213324"><span class="annot"><span class="annottext">msg :: ByteString
</span><a href="#local-6989586621679213324"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSSParams SHA512 ByteString ByteString
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hash (m :: * -&gt; *).
(HashAlgorithm hash, MonadRandom m) =&gt;
PSSParams hash ByteString ByteString
-&gt; PrivateKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">PSS.signSafer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA512 -&gt; PSSParams SHA512 ByteString ByteString
forall seed output hash.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hash) =&gt;
hash -&gt; PSSParams hash seed output
</span><span class="hs-identifier hs-var">PSS.defaultPSSParams</span></span><span> </span><span class="annot"><span class="annottext">SHA512
</span><span class="hs-identifier hs-var">H.SHA512</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679213325"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679213324"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsapssSignHash"><span class="hs-identifier hs-var">rsapssSignHash</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m (Either Error ByteString)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;rsapssSignHash: unsupported hash&quot;</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-type">rsaVerifyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PublicKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-335"></span><span id="rsaVerifyHash"><span class="annot"><span class="annottext">rsaVerifyHash :: Hash -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var hs-var">rsaVerifyHash</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-type">SHA1_MD5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MD5 -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="annot"><span class="annottext">Maybe MD5
</span><a href="Network.TLS.Crypto.html#noHash"><span class="hs-identifier hs-var">noHash</span></a></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var">rsaVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-type">MD5</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MD5 -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MD5 -&gt; Maybe MD5
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MD5
</span><span class="hs-identifier hs-var">H.MD5</span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var">rsaVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-type">SHA1</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA1 -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA1 -&gt; Maybe SHA1
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">H.SHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var">rsaVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA224"><span class="hs-identifier hs-type">SHA224</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA224 -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA224 -&gt; Maybe SHA224
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA224
</span><span class="hs-identifier hs-var">H.SHA224</span></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var">rsaVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA256 -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA256 -&gt; Maybe SHA256
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">H.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var">rsaVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA384 -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA384 -&gt; Maybe SHA384
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA384
</span><span class="hs-identifier hs-var">H.SHA384</span></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsaVerifyHash"><span class="hs-identifier hs-var">rsaVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SHA512 -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hashAlg.
HashAlgorithmASN1 hashAlg =&gt;
Maybe hashAlg -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">RSA.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA512 -&gt; Maybe SHA512
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SHA512
</span><span class="hs-identifier hs-var">H.SHA512</span></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsapssVerifyHash"><span class="hs-identifier hs-type">rsapssVerifyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PublicKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-344"></span><span id="rsapssVerifyHash"><span class="annot"><span class="annottext">rsapssVerifyHash :: Hash -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><a href="Network.TLS.Crypto.html#rsapssVerifyHash"><span class="hs-identifier hs-var hs-var">rsapssVerifyHash</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-type">SHA256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSSParams SHA256 ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hash.
HashAlgorithm hash =&gt;
PSSParams hash ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">PSS.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA256 -&gt; PSSParams SHA256 ByteString ByteString
forall seed output hash.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hash) =&gt;
hash -&gt; PSSParams hash seed output
</span><span class="hs-identifier hs-var">PSS.defaultPSSParams</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">H.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsapssVerifyHash"><span class="hs-identifier hs-var">rsapssVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA384"><span class="hs-identifier hs-type">SHA384</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSSParams SHA384 ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hash.
HashAlgorithm hash =&gt;
PSSParams hash ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">PSS.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA384 -&gt; PSSParams SHA384 ByteString ByteString
forall seed output hash.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hash) =&gt;
hash -&gt; PSSParams hash seed output
</span><span class="hs-identifier hs-var">PSS.defaultPSSParams</span></span><span> </span><span class="annot"><span class="annottext">SHA384
</span><span class="hs-identifier hs-var">H.SHA384</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsapssVerifyHash"><span class="hs-identifier hs-var">rsapssVerifyHash</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#SHA512"><span class="hs-identifier hs-type">SHA512</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSSParams SHA512 ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall hash.
HashAlgorithm hash =&gt;
PSSParams hash ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">PSS.verify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA512 -&gt; PSSParams SHA512 ByteString ByteString
forall seed output hash.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hash) =&gt;
hash -&gt; PSSParams hash seed output
</span><span class="hs-identifier hs-var">PSS.defaultPSSParams</span></span><span> </span><span class="annot"><span class="annottext">SHA512
</span><span class="hs-identifier hs-var">H.SHA512</span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span class="annot"><a href="Network.TLS.Crypto.html#rsapssVerifyHash"><span class="hs-identifier hs-var">rsapssVerifyHash</span></a></span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PublicKey -&gt; ByteString -&gt; ByteString -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;rsapssVerifyHash: unsupported hash&quot;</span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Network.TLS.Crypto.html#noHash"><span class="hs-identifier hs-type">noHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">H.MD5</span></span><span>
</span><span id="line-350"></span><span id="noHash"><span class="annot"><span class="annottext">noHash :: Maybe MD5
</span><a href="Network.TLS.Crypto.html#noHash"><span class="hs-identifier hs-var hs-var">noHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MD5
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-351"></span></pre></body></html>